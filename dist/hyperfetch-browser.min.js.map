{"version":3,"file":"hyperfetch-browser.min.js","mappings":"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","sources":["webpack://hypf/webpack/universalModuleDefinition","webpack://hypf/webpack/bootstrap","webpack://hypf/webpack/runtime/define property getters","webpack://hypf/webpack/runtime/hasOwnProperty shorthand","webpack://hypf/webpack/runtime/make namespace object","webpack://hypf/./src/Hyperfetch.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"hypf\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"hypf\"] = factory();\n\telse\n\t\troot[\"hypf\"] = factory();\n})(self, () => {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import type { \r\n  HttpRequestFunctions,\r\n  RequestFunction,\r\n  HttpMethodFunction\r\n} from \"types/request.js\";\r\nimport type { Hooks } from \"types/hooks.js\";\r\n\r\n// Default maximum recommended timeout in milliseconds (adjust as needed)\r\nconst DEFAULT_MAX_TIMEOUT = 2147483647;\r\nconst DEFAULT_BACKOFF_FACTOR = 0.3;\r\nconst DEFAULT_JITTER_FACTOR = 1;\r\n\r\nfunction appendParams(url: string, params?: Record<string, string | number>): string {\r\n  if (!params) return url;\r\n\r\n  const urlWithParams = new URL(url);\r\n  Object.entries(params).forEach(([key, value]) => urlWithParams.searchParams.append(key, String(value)));\r\n\r\n  return urlWithParams.toString();\r\n}\r\n\r\nfunction createRequest<T, U>(baseUrl?: string, hooks?: Hooks, DEBUG = false): HttpRequestFunctions<T, U> {\r\n  // Check if fetch is available (browser environment)\r\n  if (typeof fetch === 'undefined') {\r\n    throw new Error('This library is intended for use in the browser environment only.');\r\n  }\r\n\r\n  const defaultBackoff = (retryCount: number, factor: number) => Math.pow(2, retryCount) * 1000 * factor; // Exponential backoff, starting from 1 second\r\n  const defaultJitter = (factor: number) => Math.random() * 1000 * factor; // Randomized delay up to 1 second\r\n\r\n  // Expose the AbortController instance\r\n  const abortController = new AbortController();\r\n\r\n  const request: RequestFunction<T, U> = async (url = '', options = {}, data): Promise<[Error | null | unknown, U | null]> => {\r\n    try {\r\n      // Execute pre-request hook\r\n      if (hooks?.preRequest) {\r\n        hooks.preRequest(url, options);\r\n      }\r\n\r\n      const fullUrl = `${baseUrl}${url}`;\r\n      const {\r\n        method = 'GET',\r\n        retries = 0,\r\n        backoff = defaultBackoff,\r\n        jitter = false,\r\n        jitterFactor = DEFAULT_JITTER_FACTOR,\r\n        backoffFactor = DEFAULT_BACKOFF_FACTOR,\r\n        timeout = DEFAULT_MAX_TIMEOUT,\r\n        retryOnTimeout = false,\r\n        params,\r\n        headers = {},\r\n        signal,\r\n        ...otherOptions\r\n      } = options;\r\n\r\n      const reqHeaders = new Headers(options.headers);\r\n\r\n      // Set default Content-Type to application/json if not provided\r\n      if (!reqHeaders.get('Content-Type') && data && typeof data === 'object') {\r\n        reqHeaders.set('Content-Type', 'application/json');\r\n      }\r\n\r\n      // Automatically detect and add Content-Length based on payload length\r\n      const textEncoder = new TextEncoder();\r\n      if (!reqHeaders.get('Content-Length') && data) {\r\n        if (typeof data === 'string') {\r\n          reqHeaders.set('Content-Length', String(textEncoder.encode(data).length));\r\n        } else if (reqHeaders.get('Content-Length')?.includes('application/json')) {\r\n          reqHeaders.set('Content-Length', String(textEncoder.encode(JSON.stringify(data)).length));\r\n        }\r\n      }\r\n\r\n      // Use the external AbortController instance\r\n      const controller = signal ? signal : abortController.signal;\r\n\r\n      // Execute pre-timeout hook\r\n      if (hooks?.preTimeout) {\r\n        hooks.preTimeout(url, options);\r\n      }\r\n\r\n      const timeoutId = timeout ? setTimeout(() => {\r\n        abortController.abort();\r\n        \r\n        // Execute post-timeout hook\r\n        if (hooks?.postTimeout) {\r\n          hooks.postTimeout(url, options);\r\n        }\r\n      }, timeout) : undefined;\r\n\r\n      // Append params to the URL\r\n      const urlWithParams = params ? appendParams(fullUrl, params) : fullUrl;\r\n\r\n      const responsePromise = fetch(urlWithParams, {\r\n        method,\r\n        signal: controller,\r\n        headers,\r\n        ...otherOptions,\r\n        body: data ? JSON.stringify(data) : undefined,\r\n      });\r\n\r\n      clearTimeout(timeoutId);\r\n\r\n      const response = await responsePromise;\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Network response was not ok: ${response.status}`);\r\n      }\r\n\r\n      const contentType = response.headers.get('content-type');\r\n      const responseData: U = contentType && contentType.includes('application/json') ? await response.json() : await response.text();\r\n\r\n      // Execute post-request hook\r\n      if (hooks?.postRequest) {\r\n        hooks.postRequest(url, options, data, [null, responseData]);\r\n      }\r\n\r\n      return [null, responseData];\r\n    } catch (error) {\r\n      // Execute post-request hook for errors\r\n      if (hooks?.postRequest) {\r\n        hooks.postRequest(url, options, data, [error, null]);\r\n      }\r\n\r\n      if (error instanceof Error) {\r\n        if (error.name === 'AbortError') {\r\n          console.error('Request aborted:', error);\r\n        } else if (options.retryOnTimeout && error.name === 'TimeoutError' && options.retries && options.retries > 0) {\r\n          const delay = options.jitter && options.jitterFactor ? defaultJitter(options.jitterFactor) : defaultBackoff(options.retries, options.backoffFactor ? options.backoffFactor : DEFAULT_BACKOFF_FACTOR);\r\n          if (DEBUG) {\r\n            console.warn(`Request timed out. Retrying in ${delay}ms... (Remaining retries: ${options.retries})`);\r\n          }\r\n          // Execute pre-retry hook\r\n          if (hooks?.preRetry) {\r\n            hooks.preRetry(url, options, options.retries, options.retries);\r\n          }\r\n          await new Promise(resolve => setTimeout(resolve, delay));\r\n          const [retryErr, retryData] = await request(url, { ...options, retries: options.retries - 1 }, data);\r\n          // Execute post-retry hook\r\n          if (hooks?.postRetry) {\r\n            hooks.postRetry(url, options, data, [retryErr, retryData], options.retries, options.retries - 1);\r\n          }\r\n          return [retryErr, retryData];\r\n        } else if (options.retries && options.retries > 0) {\r\n          const delay = options.jitter && options.jitterFactor ? defaultJitter(options.jitterFactor) : defaultBackoff(options.retries, options.backoffFactor ? options.backoffFactor : DEFAULT_BACKOFF_FACTOR);\r\n          if (DEBUG) {\r\n            console.warn(`Request failed. Retrying in ${delay}ms... (Remaining retries: ${options.retries})`);\r\n          }\r\n          // Execute pre-retry hook\r\n          if (hooks?.preRetry) {\r\n            hooks.preRetry(url, options, options.retries, options.retries);\r\n          }\r\n          await new Promise(resolve => setTimeout(resolve, delay));\r\n          const [retryErr, retryData] = await request(url, { ...options, retries: options.retries - 1 }, data);\r\n          // Execute post-retry hook\r\n          if (hooks?.postRetry) {\r\n            hooks.postRetry(url, options, data, [retryErr, retryData], options.retries, options.retries - 1);\r\n          }\r\n          return [retryErr, retryData];\r\n        }\r\n      }\r\n      \r\n      return [error, null];\r\n    }\r\n  };\r\n\r\n  const httpMethodFunction: HttpMethodFunction<T, U> = (url, options) => (method = 'GET', additionalOptions = {}, data) => {\r\n    return request(url, { method, ...options, ...additionalOptions }, data);\r\n  };\r\n\r\n  // Expose the AbortController instance through the library interface\r\n  const getAbortController = () => abortController;\r\n\r\n  return {\r\n    get: (url, options, data) => httpMethodFunction(url, options)('GET', options, data),\r\n    post: (url, options, data) => httpMethodFunction(url, options)('POST', options, data),\r\n    put: (url, options, data) => httpMethodFunction(url, options)('PUT', options, data),\r\n    delete: (url, options, data) => httpMethodFunction(url, options)('DELETE', options, data),\r\n    patch: (url, options, data) => httpMethodFunction(url, options)('PATCH', options, data),\r\n    options: (url, options, data) => httpMethodFunction(url, options)('OPTIONS', options, data),\r\n    getAbortController,\r\n  }\r\n}\r\n\r\nexport default { createRequest };"],"names":["root","factory","exports","module","define","amd","self","__webpack_require__","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","DEFAULT_MAX_TIMEOUT","DEFAULT_BACKOFF_FACTOR","DEFAULT_JITTER_FACTOR","createRequest","baseUrl","hooks","DEBUG","fetch","Error","defaultBackoff","retryCount","factor","Math","pow","defaultJitter","random","abortController","AbortController","request","url","options","data","preRequest","fullUrl","method","retries","backoff","jitter","jitterFactor","backoffFactor","timeout","retryOnTimeout","params","headers","signal","otherOptions","reqHeaders","Headers","set","textEncoder","TextEncoder","String","encode","length","includes","JSON","stringify","controller","preTimeout","timeoutId","setTimeout","abort","postTimeout","undefined","urlWithParams","URL","entries","forEach","searchParams","append","toString","appendParams","responsePromise","body","clearTimeout","response","ok","status","contentType","responseData","json","text","postRequest","error","name","console","delay","warn","preRetry","Promise","resolve","retryErr","retryData","postRetry","httpMethodFunction","additionalOptions","post","put","delete","patch","getAbortController"],"sourceRoot":""}